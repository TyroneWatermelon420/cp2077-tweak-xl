#pragma once

#include <semver.hpp>

namespace Project
{
constexpr auto Name = L"TweakXL";
constexpr auto Author = L"psiberx";

constexpr auto Version = []() {
    auto version = semver::version(0, 1, 0);

    const std::string_view tag = "${GIT_TAG}";
    if (tag[0] == 'v')
    {
        const size_t appendix = tag.find('-');

        // v1.2.3 => 1.2.3
        // v1.2.3-type => 1.2.3-type
        if (appendix == std::string::npos || tag.find('-', appendix + 1) == std::string::npos)
        {
            version.from_string(tag.substr(1));
        }

        // v1.2.3-8-gc1234ba => 1.2.4-alpha
        else
        {
            version.from_string(tag.substr(1, appendix - 1));
            version.prerelease_type = semver::prerelease::alpha;
            version.patch++;
        }
    }

    return version;
}();
}
